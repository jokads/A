{"version":3,"file":"page-DbAs8iAW.js","sources":["../../src/pages/setup/page.tsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../../lib/supabase';\r\n\r\nexport default function SetupPage() {\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  const createAdmin = async () => {\r\n    setLoading(true);\r\n    setMessage('');\r\n    setError('');\r\n\r\n    try {\r\n      const adminEmail = 'joka2dms@gmail.com';\r\n      const adminPassword = 'ThugParadise616#';\r\n      const adminName = 'Joka Admin';\r\n\r\n      // Obter URL do Supabase\r\n      const supabaseUrl = import.meta.env.VITE_PUBLIC_SUPABASE_URL;\r\n      \r\n      if (!supabaseUrl) {\r\n        throw new Error('Configuração do Supabase não encontrada');\r\n      }\r\n\r\n      // Chamar Edge Function para criar admin (bypassa RLS)\r\n      const response = await fetch(`${supabaseUrl}/functions/v1/create-admin`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          email: adminEmail,\r\n          password: adminPassword,\r\n          fullName: adminName\r\n        })\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (!result.success) {\r\n        // Se o erro for \"usuário já existe\", tratar como sucesso\r\n        if (result.error?.includes('already registered') || result.error?.includes('já existe')) {\r\n          setMessage(`✅ Usuário já configurado!\\n\\nE-mail: ${adminEmail}\\nSenha: ${adminPassword}\\n\\nFaça login para acessar o dashboard.`);\r\n          setTimeout(() => navigate('/login'), 3000);\r\n          return;\r\n        }\r\n        throw new Error(result.error || 'Erro ao criar administrador');\r\n      }\r\n\r\n      setMessage(`✅ ${result.message}!\\n\\nE-mail: ${adminEmail}\\nSenha: ${adminPassword}\\n\\nFaça login para acessar o dashboard.`);\r\n      \r\n      setTimeout(() => navigate('/login'), 3000);\r\n\r\n    } catch (err: any) {\r\n      console.error('Erro ao criar administrador:', err);\r\n      \r\n      let errorMsg = err.message || 'Erro desconhecido ao criar administrador';\r\n      \r\n      // Tratar erro de usuário já existente como sucesso\r\n      if (errorMsg.includes('already registered') || errorMsg.includes('já existe') || errorMsg.includes('atualizado')) {\r\n        setMessage(`✅ Usuário já existe e está configurado!\\n\\nE-mail: joka2dms@gmail.com\\nSenha: ThugParadise616#\\n\\nFaça login para acessar o dashboard.`);\r\n        setTimeout(() => navigate('/login'), 3000);\r\n      } else {\r\n        setError(`❌ ${errorMsg}`);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 flex items-center justify-center p-6\">\r\n      <div className=\"max-w-md w-full bg-gray-800 rounded-2xl shadow-2xl p-8 border border-yellow-500/20\">\r\n        <div className=\"text-center mb-8\">\r\n          <div className=\"w-20 h-20 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n            <i className=\"ri-admin-line text-4xl text-black\"></i>\r\n          </div>\r\n          <h1 className=\"text-3xl font-bold text-white mb-2\">Configuração Inicial</h1>\r\n          <p className=\"text-gray-400\">Crie o usuário administrador do sistema</p>\r\n        </div>\r\n\r\n        <div className=\"bg-gray-900/50 rounded-lg p-6 mb-6 border border-gray-700\">\r\n          <h2 className=\"text-lg font-semibold text-yellow-400 mb-4\">Credenciais do Admin:</h2>\r\n          <div className=\"space-y-3 text-sm\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-400\">E-mail:</span>\r\n              <span className=\"text-white font-mono\">joka2dms@gmail.com</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-400\">Senha:</span>\r\n              <span className=\"text-white font-mono\">ThugParadise616#</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-400\">Permissão:</span>\r\n              <span className=\"text-yellow-400 font-semibold\">Superadmin</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {message && (\r\n          <div className=\"bg-green-500/10 border border-green-500/50 rounded-lg p-4 mb-6\">\r\n            <p className=\"text-green-400 text-sm whitespace-pre-line\">{message}</p>\r\n          </div>\r\n        )}\r\n\r\n        {error && (\r\n          <div className=\"bg-red-500/10 border border-red-500/50 rounded-lg p-4 mb-6\">\r\n            <p className=\"text-red-400 text-sm\">{error}</p>\r\n          </div>\r\n        )}\r\n\r\n        <button\r\n          onClick={createAdmin}\r\n          disabled={loading}\r\n          className=\"w-full bg-gradient-to-r from-yellow-400 to-yellow-600 text-black font-semibold py-4 rounded-lg hover:from-yellow-500 hover:to-yellow-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 whitespace-nowrap\"\r\n        >\r\n          {loading ? (\r\n            <>\r\n              <div className=\"w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin\"></div>\r\n              <span>Criando...</span>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <i className=\"ri-user-add-line text-xl\"></i>\r\n              <span>Criar Administrador</span>\r\n            </>\r\n          )}\r\n        </button>\r\n\r\n        <div className=\"mt-6 text-center\">\r\n          <button\r\n            onClick={() => navigate('/login')}\r\n            className=\"text-gray-400 hover:text-yellow-400 transition-colors text-sm whitespace-nowrap\"\r\n          >\r\n            Já tenho uma conta → Fazer Login\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["SetupPage","loading","setLoading","useState","message","setMessage","error","setError","navigate","useNavigate","createAdmin","adminEmail","adminPassword","adminName","supabaseUrl","result","err","errorMsg","jsxs","jsx","Fragment"],"mappings":"sDAIA,SAAwBA,GAAY,CAClC,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAK,EACtC,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAE,EACnC,CAACG,EAAOC,CAAQ,EAAIJ,EAAAA,SAAS,EAAE,EAC/BK,EAAWC,EAAA,EAEXC,EAAc,SAAY,CAC9BR,EAAW,EAAI,EACfG,EAAW,EAAE,EACbE,EAAS,EAAE,EAEX,GAAI,CACF,MAAMI,EAAa,qBACbC,EAAgB,mBAChBC,EAAY,aAGZC,EAAc,2CAmBdC,EAAS,MAZE,MAAM,MAAM,GAAGD,CAAW,6BAA8B,CACvE,OAAQ,OACR,QAAS,CACP,eAAgB,kBAAA,EAElB,KAAM,KAAK,UAAU,CACnB,MAAOH,EACP,SAAUC,EACV,SAAUC,CAAA,CACX,CAAA,CACF,GAE6B,KAAA,EAE9B,GAAI,CAACE,EAAO,QAAS,CAEnB,GAAIA,EAAO,OAAO,SAAS,oBAAoB,GAAKA,EAAO,OAAO,SAAS,WAAW,EAAG,CACvFV,EAAW;AAAA;AAAA,UAAwCM,CAAU;AAAA,SAAYC,CAAa;AAAA;AAAA,qCAA0C,EAChI,WAAW,IAAMJ,EAAS,QAAQ,EAAG,GAAI,EACzC,MACF,CACA,MAAM,IAAI,MAAMO,EAAO,OAAS,6BAA6B,CAC/D,CAEAV,EAAW,KAAKU,EAAO,OAAO;AAAA;AAAA,UAAgBJ,CAAU;AAAA,SAAYC,CAAa;AAAA;AAAA,qCAA0C,EAE3H,WAAW,IAAMJ,EAAS,QAAQ,EAAG,GAAI,CAE3C,OAASQ,EAAU,CACjB,QAAQ,MAAM,+BAAgCA,CAAG,EAEjD,IAAIC,EAAWD,EAAI,SAAW,2CAG1BC,EAAS,SAAS,oBAAoB,GAAKA,EAAS,SAAS,WAAW,GAAKA,EAAS,SAAS,YAAY,GAC7GZ,EAAW;AAAA;AAAA;AAAA;AAAA;AAAA,qCAAwI,EACnJ,WAAW,IAAMG,EAAS,QAAQ,EAAG,GAAI,GAEzCD,EAAS,KAAKU,CAAQ,EAAE,CAE5B,QAAA,CACEf,EAAW,EAAK,CAClB,CACF,EAEA,aACG,MAAA,CAAI,UAAU,0GACb,SAAAgB,EAAAA,KAAC,MAAA,CAAI,UAAU,qFACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,uHACb,eAAC,IAAA,CAAE,UAAU,mCAAA,CAAoC,EACnD,QACC,KAAA,CAAG,UAAU,qCAAqC,SAAA,uBAAoB,QACtE,IAAA,CAAE,UAAU,gBAAgB,SAAA,0CAAuC,CAAA,EACtE,EAEAD,EAAAA,KAAC,MAAA,CAAI,UAAU,4DACb,SAAA,OAAC,KAAA,CAAG,UAAU,6CAA6C,SAAA,wBAAqB,EAChFA,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,OAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,UAAO,QACtC,OAAA,CAAK,UAAU,uBAAuB,SAAA,qBAAkB,CAAA,EAC3D,EACAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,OAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,SAAM,QACrC,OAAA,CAAK,UAAU,uBAAuB,SAAA,mBAAgB,CAAA,EACzD,EACAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,OAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,aAAU,QACzC,OAAA,CAAK,UAAU,gCAAgC,SAAA,aAAU,CAAA,EAC5D,CAAA,EACF,CAAA,EACF,EAECd,GACCe,EAAAA,IAAC,MAAA,CAAI,UAAU,iEACb,eAAC,IAAA,CAAE,UAAU,6CAA8C,SAAAf,CAAA,CAAQ,EACrE,EAGDE,GACCa,EAAAA,IAAC,MAAA,CAAI,UAAU,6DACb,eAAC,IAAA,CAAE,UAAU,uBAAwB,SAAAb,CAAA,CAAM,EAC7C,EAGFa,EAAAA,IAAC,SAAA,CACC,QAAST,EACT,SAAUT,EACV,UAAU,gRAET,WACCiB,EAAAA,KAAAE,EAAAA,SAAA,CACE,SAAA,CAAAD,EAAAA,IAAC,MAAA,CAAI,UAAU,+EAA+E,EAC9FA,EAAAA,IAAC,QAAK,SAAA,aAAU,CAAA,EAClB,EAEAD,EAAAA,KAAAE,EAAAA,SAAA,CACE,SAAA,CAAAD,EAAAA,IAAC,IAAA,CAAE,UAAU,2BAA2B,EACxCA,EAAAA,IAAC,QAAK,SAAA,sBAAmB,CAAA,EAC3B,CAAA,CAAA,EAIJA,EAAAA,IAAC,MAAA,CAAI,UAAU,mBACb,SAAAA,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMX,EAAS,QAAQ,EAChC,UAAU,kFACX,SAAA,kCAAA,CAAA,EAGH,CAAA,CAAA,CACF,CAAA,CACF,CAEJ"}